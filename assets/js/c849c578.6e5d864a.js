"use strict";(self.webpackChunk_hirosystems_docs=self.webpackChunk_hirosystems_docs||[]).push([[7250],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=a.createContext({}),s=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=s(e.components);return a.createElement(c.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,c=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=s(n),h=r,m=p["".concat(c,".").concat(h)]||p[h]||d[h]||o;return n?a.createElement(m,i(i({ref:t},u),{},{components:n})):a.createElement(m,i({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=h;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l[p]="string"==typeof e?e:r,i[1]=l;for(var s=2;s<o;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},54475:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var a=n(87462),r=(n(67294),n(3905));const o={id:"clarity-counter",title:"Counter"},i=void 0,l={unversionedId:"tutorials/clarity-counter",id:"tutorials/clarity-counter",title:"Counter",description:"This tutorial introduces variables in Clarity, and demonstrates how to interact with them through a simple incrementing",source:"@site/docs/tutorials/clarity-counter.md",sourceDirName:"tutorials",slug:"/tutorials/clarity-counter",permalink:"/doc/tutorials/clarity-counter",draft:!1,editUrl:"https://github.com/CapybaraIO/doc/tree/main/docs/tutorials/clarity-counter.md",tags:[],version:"current",lastUpdatedAt:1703206175,formattedLastUpdatedAt:"Dec 22, 2023",frontMatter:{id:"clarity-counter",title:"Counter"},sidebar:"tutorials",previous:{title:"Hello, world",permalink:"/doc/tutorials/clarity-hello-world"},next:{title:"Billboard",permalink:"/doc/tutorials/clarity-billboard"}},c={},s=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Optional prerequisites",id:"optional-prerequisites",level:3},{value:"Step 1: create a new project",id:"step-1-create-a-new-project",level:2},{value:"Step 2: create a new contract",id:"step-2-create-a-new-contract",level:2},{value:"Step 3: define variables",id:"step-3-define-variables",level:2},{value:"Step 4: define counter functions",id:"step-4-define-counter-functions",level:2},{value:"Step 5: interact with the contract on the Clarinet console",id:"step-5-interact-with-the-contract-on-the-clarinet-console",level:2},{value:"Optional: deploy and test the contract on the testnet",id:"optional-deploy-and-test-the-contract-on-the-testnet",level:2}],u={toc:s},p="wrapper";function d(e){let{components:t,...o}=e;return(0,r.kt)(p,(0,a.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"This tutorial introduces variables in Clarity, and demonstrates how to interact with them through a simple incrementing\nand decrementing counter. This tutorial builds on concepts introduced in the ","[hello world tutorial][]"," and continues to\nexercise ","[Clarinet][]"," as a local development environment."),(0,r.kt)("p",null,"In this tutorial you will:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Create a new Clarinet project"),(0,r.kt)("li",{parentName:"ul"},"Add a new Clarity contract to the project"),(0,r.kt)("li",{parentName:"ul"},"Populate the contract with a variable and read variable function"),(0,r.kt)("li",{parentName:"ul"},"Populate the contract with an increment and a decrement function"),(0,r.kt)("li",{parentName:"ul"},"Execute the functions in a local, simulated blockchain"),(0,r.kt)("li",{parentName:"ul"},"Optionally, deploy and test the contract on the testnet blockchain")),(0,r.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,r.kt)("p",null,"For this tutorial, you should have a local installation of Clarinet. Refer to ","[Installing Clarinet][]"," for instructions\non how to set up your local environment. You should also have a text editor or IDE to edit the Clarity smart contract."),(0,r.kt)("p",null,"If you are using Visual Studio Code, you may want to install the ","[Clarity Visual Studio Code plugin][]","."),(0,r.kt)("h3",{id:"optional-prerequisites"},"Optional prerequisites"),(0,r.kt)("p",null,"While this tutorial primarily focuses on local smart contract development, you may wish to deploy your contract to\na live blockchain. For simplicity, contract deployment is performed using the ","[testnet sandbox][]",". If you wish to\ncomplete the optional deployment step, you should have the ","[Leather wallet][]"," installed, and you should request\ntestnet STX tokens from the ","[testnet faucet][]"," on the testnet explorer. Note that requesting testnet STX from the faucet\ncan take up to 15 minutes, so you may wish to request the tokens before beginning the tutorial."),(0,r.kt)("h2",{id:"step-1-create-a-new-project"},"Step 1: create a new project"),(0,r.kt)("p",null,"With Clarinet installed locally, open a new terminal window and create a new Clarinet project with the command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"clarinet new clarity-counter && cd clarity-counter\n")),(0,r.kt)("p",null,"This command creates a new directory for your smart contract project, populated with boilerplate configuration and\ntesting files. Creating a new project only creates the Clarinet configuration, in the next step you can add a contract\nto the project."),(0,r.kt)("h2",{id:"step-2-create-a-new-contract"},"Step 2: create a new contract"),(0,r.kt)("p",null,"From the ",(0,r.kt)("inlineCode",{parentName:"p"},"clarity-counter")," directory, create a new Clarity contract with the command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"clarinet contract new counter\n")),(0,r.kt)("p",null,"This command adds a new ",(0,r.kt)("inlineCode",{parentName:"p"},"counter.clar")," file in the ",(0,r.kt)("inlineCode",{parentName:"p"},"contracts")," directory, and adds a ",(0,r.kt)("inlineCode",{parentName:"p"},"counter_test.ts")," file to\nthe ",(0,r.kt)("inlineCode",{parentName:"p"},"test")," directory. This tutorial ignores the test file, but for production contracts, you can create ","[unit tests][]","\nusing it."),(0,r.kt)("h2",{id:"step-3-define-variables"},"Step 3: define variables"),(0,r.kt)("p",null,"Open the ",(0,r.kt)("inlineCode",{parentName:"p"},"contracts/counter.clar")," file in a text editor or IDE. Delete the boilerplate comments, for the purpose of\nthis tutorial they're not necessary."),(0,r.kt)("p",null,"In this step, you'll add a variable to the contract, and define a read-only function to output the value of that\nvariable."),(0,r.kt)("p",null,"Start by defining the variable on the first line"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-clarity"},";; define counter variable\n(define-data-var counter int 0)\n")),(0,r.kt)("p",null,"The ","[",(0,r.kt)("inlineCode",{parentName:"p"},"define-data-var"),"][]"," statement initializes a new integer variable named ",(0,r.kt)("inlineCode",{parentName:"p"},"counter")," and sets the initial value to\n",(0,r.kt)("inlineCode",{parentName:"p"},"0"),". It's important to note that all definition statements in Clarity need to be at the top of the file."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"counter")," variable is stored in the data space associated with the smart contract. The variable is persisted and"),(0,r.kt)("p",null,"acts as a global shared state."),(0,r.kt)("p",null,"To provide access to the ",(0,r.kt)("inlineCode",{parentName:"p"},"counter")," variable from outside the contract that it's defined in, you should declare a\n",(0,r.kt)("inlineCode",{parentName:"p"},"read-only")," function to get the value. Add this function below the variable definition:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-clarity"},";; counter getter\n(define-read-only (get-counter)\n  (ok (var-get counter)))\n")),(0,r.kt)("p",null,"The ","[",(0,r.kt)("inlineCode",{parentName:"p"},"var-get"),"][]"," statement looks for a variable in the contract's data space and returns it."),(0,r.kt)("p",null,"Your contract code should now look like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-clarity"},";; define counter variable\n(define-data-var counter int 0)\n\n;; counter getter\n(define-read-only (get-counter)\n  (ok (var-get counter)))\n")),(0,r.kt)("p",null,"At this point, you can check your contract code to ensure the syntax is correct. In the ",(0,r.kt)("inlineCode",{parentName:"p"},"clarity-counter")," directory in\nyour terminal, use the command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"clarinet check\n")),(0,r.kt)("p",null,"If there are no errors, the command returns no output. If there are errors, verify that your contract is exactly as\nlisted in the preceding section. You can also use the ","[",(0,r.kt)("inlineCode",{parentName:"p"},"clarinet console"),"][]"," to interact with the ",(0,r.kt)("inlineCode",{parentName:"p"},"get-counter"),"\nfunction:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-clarity"},"(contract-call? .counter get-counter)\n")),(0,r.kt)("p",null,"The console should return ",(0,r.kt)("inlineCode",{parentName:"p"},"(ok 0)"),"."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Changes to your contract will not be loaded into the Clarinet console until it is restarted. Close the console with\n",(0,r.kt)("inlineCode",{parentName:"p"},"Ctrl + C")," before proceding to the next step.")),(0,r.kt)("h2",{id:"step-4-define-counter-functions"},"Step 4: define counter functions"),(0,r.kt)("p",null,"In this step, you'll add functions to increment and decrement the counter variable. Add the ",(0,r.kt)("inlineCode",{parentName:"p"},"increment")," function to\nthe contract after the counter getter:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-clarity"},";; increment method\n(define-public (increment)\n  (begin\n    (var-set counter (+ (var-get counter) 1))\n    (ok (var-get counter))))\n")),(0,r.kt)("p",null,"The ","[",(0,r.kt)("inlineCode",{parentName:"p"},"begin"),"][]"," statement evaluates multiple expressions and returns the value of the last on. In this case, it\nevaluates an expression to set a new value for the ",(0,r.kt)("inlineCode",{parentName:"p"},"counter")," variable, and then returns the new value."),(0,r.kt)("p",null,"The first expression in the ",(0,r.kt)("inlineCode",{parentName:"p"},"begin")," statement is the ","[",(0,r.kt)("inlineCode",{parentName:"p"},"var-set"),"][]"," expression, which sets a new value for the counter\nvariable. The new value is constructed using the ","[",(0,r.kt)("inlineCode",{parentName:"p"},"+"),"]"," (add) statement. This statement takes a number of integer\narguments and returns the sum of the integers. Along with add, Clarity provides statements to subtract, multiply, and\ndivide integers. Find more details in the ","[Clarity language reference][]","."),(0,r.kt)("p",null,"Next, implement a new public function ",(0,r.kt)("inlineCode",{parentName:"p"},"decrement")," to subtract ",(0,r.kt)("inlineCode",{parentName:"p"},"1")," from the counter variable:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-clarity"},";; decrement method\n(define-public (decrement)\n  (begin\n    (var-set counter (- (var-get counter) 1))\n    (ok (var-get counter))))\n")),(0,r.kt)("p",null,"At this point the contract is complete. The full ",(0,r.kt)("inlineCode",{parentName:"p"},"counter.clar")," file should look like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-clarity"},";; define counter variable\n(define-data-var counter int 0)\n\n;; counter getter\n(define-read-only (get-counter)\n  (ok (var-get counter)))\n\n;; increment method\n(define-public (increment)\n  (begin\n    (var-set counter (+ (var-get counter) 1))\n    (ok (var-get counter))))\n\n;; decrement method\n(define-public (decrement)\n  (begin\n    (var-set counter (- (var-get counter) 1))\n    (ok (var-get counter))))\n")),(0,r.kt)("h2",{id:"step-5-interact-with-the-contract-on-the-clarinet-console"},"Step 5: interact with the contract on the Clarinet console"),(0,r.kt)("p",null,"Run ",(0,r.kt)("inlineCode",{parentName:"p"},"clarinet check")," again to verify that the syntax in your contract is correct. If there are no errors, the command\nreturns no output. Use the following command to launch the local console:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"clarinet console\n")),(0,r.kt)("p",null,"You'll use the console to interact with the functions in your contract. Call the ",(0,r.kt)("inlineCode",{parentName:"p"},"increment")," function to increment the\ncounter in the console:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-clarity"},"(contract-call? .counter increment)\n")),(0,r.kt)("p",null,"The console should return ",(0,r.kt)("inlineCode",{parentName:"p"},"(ok 1)"),". Try calling the ",(0,r.kt)("inlineCode",{parentName:"p"},"decrement")," function to decrement the counter back to 0."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-clarity"},"(contract-call? .counter decrement)\n")),(0,r.kt)("p",null,"You have now learned the basics of working with variables in Clarity, and developed further practice with the\nClarinet development tool. You may wish to optionally deploy the contract to the testnet, described in the next and\nfinal step."),(0,r.kt)("h2",{id:"optional-deploy-and-test-the-contract-on-the-testnet"},"Optional: deploy and test the contract on the testnet"),(0,r.kt)("p",null,"For this tutorial, you'll use the ","[testnet sandbox][]"," to deploy your smart contract. Make sure you have connected your\n","[Leather wallet][]"," to the sandbox using the ",(0,r.kt)("strong",{parentName:"p"},"Connect wallet")," button, then copy and paste your smart contract into\nthe Clarity code editor on the ",(0,r.kt)("strong",{parentName:"p"},"Write & Deploy")," page. Edit the contract name or use the randomly generated name\nprovided to you."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Counter testnet sandbox",src:n(65363).Z,width:"1131",height:"423"})),(0,r.kt)("p",null,"Click ",(0,r.kt)("strong",{parentName:"p"},"Deploy")," to deploy the contract to the blockchain. This will display the Leather wallet window with\ninformation about the transaction. Verify that the transaction looks correct, and the network is set to ",(0,r.kt)("inlineCode",{parentName:"p"},"Testnet"),", and\nclick ",(0,r.kt)("strong",{parentName:"p"},"Confirm"),"."),(0,r.kt)("p",null,"The contract is added to the miners mempool, and included in the next block of the blockchain. This process can take up\nto 15 minutes to complete. You can review it on the ","[transactions][]"," page of the explorer or in the activity field\nof your web wallet."),(0,r.kt)("p",null,"When your contract is confirmed, navigate to the ","[call a contract][]"," page of the sandbox, and search for your contract.\nEnter your wallet address in the top field, you can copy this address by clicking the Leather wallet icon and\nclicking the ",(0,r.kt)("strong",{parentName:"p"},"Copy address")," button. Enter the contract name in the bottom field, in this case ",(0,r.kt)("inlineCode",{parentName:"p"},"counter"),". Click\n",(0,r.kt)("strong",{parentName:"p"},"Get Contract")," to view the contract."),(0,r.kt)("p",null,"Click the ",(0,r.kt)("inlineCode",{parentName:"p"},"increment")," function in the function summary, then click ",(0,r.kt)("strong",{parentName:"p"},"Call Function")," to perform the function call in the\nsandbox. This will display the Leather wallet with information about the transaction. Verify the information, then\nclick ",(0,r.kt)("strong",{parentName:"p"},"Confirm")," to execute the function call."),(0,r.kt)("p",null,"The function call is added to the miners mempool, and is executed in the next block of the blockchain. This process\ncan take up to 15 minutes to complete. You can review it on the ","[transactions][]"," page of the explorer or in the\nactivity field of your web wallet."),(0,r.kt)("p",null,"When the transaction is complete, you can access the transaction summary page from the activity panel in your web\nwallet. The transaction summary page displays the output of the function."),(0,r.kt)("p",null,"Try calling the other public functions from the ","[call a contract][]"," page."),(0,r.kt)("p",null,"You have now learned one method of deploying and interacting with smart contracts on Stacks. You have also learned\nthe strengths of performing local development without having to wait for block times."))}d.isMDXComponent=!0},65363:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/counter-testnet-sandbox-7a6d0990faec40da4eb1617dc3c57960.png"}}]);