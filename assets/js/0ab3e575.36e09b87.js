"use strict";(self.webpackChunk_hirosystems_docs=self.webpackChunk_hirosystems_docs||[]).push([[41],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>m});var r=t(67294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=r.createContext({}),l=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=l(e.components);return r.createElement(s.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},h=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),u=l(t),h=o,m=u["".concat(s,".").concat(h)]||u[h]||d[h]||a;return t?r.createElement(m,i(i({ref:n},p),{},{components:t})):r.createElement(m,i({ref:n},p))}));function m(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,i=new Array(a);i[0]=h;var c={};for(var s in n)hasOwnProperty.call(n,s)&&(c[s]=n[s]);c.originalType=e,c[u]="string"==typeof e?e:o,i[1]=c;for(var l=2;l<a;l++)i[l]=t[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}h.displayName="MDXCreateElement"},22602:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>c,toc:()=>l});var r=t(87462),o=(t(67294),t(3905));const a={Title:"Nonce Handling"},i="Nonce handling",c={unversionedId:"stacks-blockchain-api/feature-guides/nonce-handling",id:"stacks-blockchain-api/feature-guides/nonce-handling",title:"Nonce handling",description:'In order to prevent "stuck" transactions, you must track the next available nonce for principals issuing transactions. The',source:"@site/docs/stacks-blockchain-api/feature-guides/nonce-handling.md",sourceDirName:"stacks-blockchain-api/feature-guides",slug:"/stacks-blockchain-api/feature-guides/nonce-handling",permalink:"/doc/stacks-blockchain-api/feature-guides/nonce-handling",draft:!1,editUrl:"https://github.com/CapybaraIO/doc/tree/main/docs/stacks-blockchain-api/feature-guides/nonce-handling.md",tags:[],version:"current",frontMatter:{Title:"Nonce Handling"},sidebar:"stacks-api",previous:{title:"Requesting Proofs",permalink:"/doc/stacks-blockchain-api/feature-guides/requesting-proofs"},next:{title:"Rosetta Support",permalink:"/doc/stacks-blockchain-api/feature-guides/rosetta-support"}},s={},l=[],p={toc:l},u="wrapper";function d(e){let{components:n,...t}=e;return(0,o.kt)(u,(0,r.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"nonce-handling"},"Nonce handling"),(0,o.kt)("p",null,'In order to prevent "stuck" transactions, you must track the next available nonce for principals issuing transactions. The\nStacks Blockchain API provides an endpoint to make nonce handling simpler when using the following command:'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"# for mainnet, remove `.testnet`\n# replace <principal> with your STX address\ncurl 'https://api.testnet.hiro.so/extended/v1/address/<principal>/nonces'\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "last_executed_tx_nonce": 5893,\n  "last_mempool_tx_nonce": null,\n  "possible_next_nonce": 5894,\n  "detected_missing_nonces": []\n}\n')),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"possible_next_nonce")," property is the predicted nonce required for subsequent transactions, which is derived from inspecting the latest transaction nonces from both anchor blocks, microblocks, and mempool."),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"detected_missing_nonces")," property finds any non-contiguous nonces after inspecting transactions from anchor blocks, microblocks, and the mempool. For example, if the latest anchor/microblock transaction nonce for an account is 5, but the next nonce in the mempool is 7, then it indicates that something likely went wrong with transaction with nonce 6 (either it was not created or broadcasted correctly by a client, or it was dropped for whatever reason). This is a strong indication that the mempool transaction with nonce 7 will never be mined since the previous nonce is missing."),(0,o.kt)("p",null,"Clients that continue to broadcast transactions with the ",(0,o.kt)("inlineCode",{parentName:"p"},"possible_next_nonce")," property of 8, then 9, then 10, will likely result in all of their pending/mempool transactions never going through."))}d.isMDXComponent=!0}}]);