"use strict";(self.webpackChunk_hirosystems_docs=self.webpackChunk_hirosystems_docs||[]).push([[8635],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>h});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),c=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},d="mdxType",k={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=c(a),u=r,h=d["".concat(l,".").concat(u)]||d[u]||k[u]||o;return a?n.createElement(h,i(i({ref:t},p),{},{components:a})):n.createElement(h,i({ref:t},p))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:r,i[1]=s;for(var c=2;c<o;c++)i[c]=a[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},87097:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>k,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var n=a(87462),r=(a(67294),a(3905));const o={title:"Stacks 2.1 Upgrades"},i=void 0,s={unversionedId:"stacks-2.1-upgrades",id:"stacks-2.1-upgrades",title:"Stacks 2.1 Upgrades",description:"Overview",source:"@site/docs/stacks-2.1-upgrades.md",sourceDirName:".",slug:"/stacks-2.1-upgrades",permalink:"/stacks-2.1-upgrades",draft:!1,editUrl:"https://github.com/hirosystems/docs/tree/main/docs/stacks-2.1-upgrades.md",tags:[],version:"current",frontMatter:{title:"Stacks 2.1 Upgrades"}},l={},c=[{value:"Overview",id:"overview",level:2},{value:"What is Stacks 2.1?",id:"what-is-stacks-21",level:2},{value:"What is PoX-2?",id:"what-is-pox-2",level:2},{value:"PoX-2 periods",id:"pox-2-periods",level:3},{value:"Clarinet",id:"clarinet",level:2},{value:"Contract settings",id:"contract-settings",level:3},{value:"Update Devnet settings",id:"update-devnet-settings",level:3},{value:"Stacks Blockchain API",id:"stacks-blockchain-api",level:2},{value:"Distinguish contract versions",id:"distinguish-contract-versions",level:3},{value:"Coinbase payouts",id:"coinbase-payouts",level:3},{value:"PoX-2 support for Rosetta API",id:"pox-2-support-for-rosetta-api",level:3},{value:"Stacks.js",id:"stacksjs",level:2},{value:"New PoX interactive functions for Clarity",id:"new-pox-interactive-functions-for-clarity",level:3},{value:"New helper methods",id:"new-helper-methods",level:3},{value:"Migration",id:"migration",level:3},{value:"References",id:"references",level:2}],p={toc:c},d="wrapper";function k(e){let{components:t,...o}=e;return(0,r.kt)(d,(0,n.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"overview"},"Overview"),(0,r.kt)("p",null,"In this article, you will learn about Stacks 2.05 to 2.1 migration and how the Hiro product changes reflect this upgrade."),(0,r.kt)("h2",{id:"what-is-stacks-21"},"What is Stacks 2.1?"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://stacks.org/stacks-21-what-to-expect"},"Stacks 2.1")," is a fork and protocol upgrade of the Stacks blockchain. Among ",(0,r.kt)("a",{parentName:"p",href:"https://www.hiro.so/blog/a-developers-guide-to-stacks-2-1"},"other improvements"),", Stacks 2.1 includes an updated ",(0,r.kt)("a",{parentName:"p",href:"https://docs.stacks.co/docs/understand-stacks/proof-of-transfer"},"Proof-of-Transfer")," (PoX) ",(0,r.kt)("a",{parentName:"p",href:"https://docs.stacks.co/docs/clarity/noteworthy-contracts/stacking-contract"},"contract"),' (often informally referred to as "PoX-2") for Stacking. Stacking allows users to lock up STX to support the network and earn BTC. For more information on stacking changes, refer to ',(0,r.kt)("a",{parentName:"p",href:"https://www.hiro.so/blog/how-the-stacks-2-1-transition-impacts-stacking"},"How Stacks 2.1 Impacts Stacking"),"."),(0,r.kt)("h2",{id:"what-is-pox-2"},"What is PoX-2?"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://docs.stacks.co/docs/understand-stacks/proof-of-transfer"},"Proof-of-transfer (PoX)")," is a consensus mechanism in modern blockchains. In Stacks 2.05 or earlier versions, this consensus mechanism uses the ",(0,r.kt)("inlineCode",{parentName:"p"},".pox")," (",(0,r.kt)("a",{parentName:"p",href:"https://explorer.hiro.so/txid/SP000000000000000000002Q6VF78.pox?chain=mainnet&_gl=1*6fljeg*_ga*MTY3NTgyOTg2OS4xNjY2MjA3NDM3*_ga_NB2VBT0KY2*MTY3MDk1ODcyNS4xMTEuMC4xNjcwOTU4NzI1LjAuMC4w"},"boot/pox.clar"),", aka PoX-1) boot smart contract. With the Stacks 2.1 upgrade, the new fork is updated to ",(0,r.kt)("inlineCode",{parentName:"p"},".pox-2")," (",(0,r.kt)("a",{parentName:"p",href:"https://github.com/stacks-network/stacks-blockchain/blob/master/src/chainstate/stacks/boot/pox-2.clar"},"boot/pox-2.clar"),", aka PoX-2)."),(0,r.kt)("h3",{id:"pox-2-periods"},"PoX-2 periods"),(0,r.kt)("p",null,"The PoX-2 fork evolves in the following periods. Hiro products adapt to these periods to align with the new ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/stacksgov/sips/blob/a17d318321abf0754e8b2ce5706a9d25493d42ee/sips/sip-015/sip-015-network-upgrade.md"},"network upgrade \u2014 SIP-015"),"."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"Period 1"))," \u2014 Stacks 2.0 and PoX-1 consensus rules in effect."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"Period 2"))," \u2014 PoX-1 is still active. Stacking or delegating can start with PoX-2.",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"Period 2a"))," \u2014 PoX-1 deactivates and PoX-2 is now active. Tokens locked in PoX-1 contract unlock."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"Period 2b"))," \u2014 In the 2.1 fork, after v1_unlock_height, but before the first PoX-2 reward cycle."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"Period 3"))," \u2014 PoX-2 is active. The first PoX-2 reward cycle starts.")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"NOTE:"))),(0,r.kt)("p",{parentName:"blockquote"},"PoX-2 is not immediately used for reward cycles after the 2.1 fork. Period 2 (2a and 2b) allows stackers to stack and delegate their funds using PoX-2.")),(0,r.kt)("p",null,'The currently "active" PoX contract will determine the reward set for the upcoming reward cycle. If PoX-1 is the "active" contract, the next reward cycle will read from the smart-contract state of PoX-1 to determine ',(0,r.kt)("strong",{parentName:"p"},"who is paid out to"),' for Proof-of-Transfer consensus. The transition when PoX-2 is "active," but the current reward set is still being read from PoX-1 state is ',(0,r.kt)("em",{parentName:"p"},"Period 2b"),"."),(0,r.kt)("p",null,"To understand more about PoX-2 activation, reward cycles, and phases, refer to the below diagram."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image",src:a(49407).Z,width:"3000",height:"925"})),(0,r.kt)("p",null,"Now that you have a general understanding of Stacks 2.1 and the PoX changes and what to expect, let's dive into each product and understand the new features or improvements to the existing features for Stacks 2.1 upgrade."),(0,r.kt)("h2",{id:"clarinet"},"Clarinet"),(0,r.kt)("p",null,"This section explains the Stacks 2.1 upgrade for Clarinet."),(0,r.kt)("h3",{id:"contract-settings"},"Contract settings"),(0,r.kt)("p",null,"In your project's ",(0,r.kt)("inlineCode",{parentName:"p"},"Clarinet.toml")," file, you can now specify the epoch during which a contract should be deployed, and the Clarity version it uses. Note that you may ",(0,r.kt)("strong",{parentName:"p"},"only")," select the Clarity version in epoch 2.1."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-toml"},'[contracts.cbtc-token]\npath = "contracts/cbtc-token.clar"\nclarity_version = 2\nepoch = "2.1"\n')),(0,r.kt)("h3",{id:"update-devnet-settings"},"Update Devnet settings"),(0,r.kt)("p",null,"This section helps you update your Devnet settings to work with the Stacks 2.1 upgrade."),(0,r.kt)("p",null,"If you are new to Clarinet, refer to the ",(0,r.kt)("a",{parentName:"p",href:"/clarinet/getting-started"},"Getting started")," guide to install clarinet, ",(0,r.kt)("a",{parentName:"p",href:"/clarinet/guides/how-to-set-up-local-development-environment"},"set up local development environment")," and ",(0,r.kt)("a",{parentName:"p",href:"/clarinet/guides/how-to-create-new-project"},"create your project"),"."),(0,r.kt)("p",null,"To upgrade your clarinet version, you can ",(0,r.kt)("a",{parentName:"p",href:"/clarinet/getting-started#install-from-a-pre-built-binary"},"install from a pre-built binary")," or ",(0,r.kt)("a",{parentName:"p",href:"/clarinet/getting-started#install-from-source-using-cargo"},"install from source using Cargo"),"."),(0,r.kt)("p",null,"After installing the latest version of Clarinet, navigate to your project directory and then to ",(0,r.kt)("inlineCode",{parentName:"p"},"settings/Devnet.toml")," (hereafter referred to as ",(0,r.kt)("strong",{parentName:"p"},"devnet.toml"),")."),(0,r.kt)("p",null,"Find the section ","[devnet]"," with the following settings."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-toml"},"[devnet]\ndisable_stacks_explorer = false\ndisable_stacks_api = false\n")),(0,r.kt)("p",null,"Add a new setting, ",(0,r.kt)("inlineCode",{parentName:"p"},"enable_next_features = true,")," and keep the remaining settings as-is."),(0,r.kt)("p",null,"The updated Devnet.toml looks like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-toml"},"[devnet]\nenable_next_features = true\ndisable_stacks_explorer = false\ndisable_stacks_api = false\n")),(0,r.kt)("p",null,"Spin up a local Devnet network using the command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"clarinet integrate\n")),(0,r.kt)("p",null,"If you have any trouble with the above command, refer to the ",(0,r.kt)("a",{parentName:"p",href:"/clarinet/troubleshooting"},"troubleshooting guide")," or report an issue ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/hirosystems/clarinet/issues"},"here"),"."),(0,r.kt)("p",null,"New stacks-node will spin up. At Bitcoin block height 102, the chainstate will migrate to epoch 2.05, a network upgrade introduced earlier this year, reducing operations costs. At bitcoin block height 106, the chainstate will migrate to epoch 2.1."),(0,r.kt)("p",null,"As shown in the below screenshot, the epoch changes are indicated in the ",(0,r.kt)("em",{parentName:"p"},"Transactions")," section ",(0,r.kt)("inlineCode",{parentName:"p"},"deployed: ST00000000000000002AMW42H.costs-3 (ok true).")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"image",src:a(48133).Z,width:"2642",height:"1244"})),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"NOTE")),(0,r.kt)("p",{parentName:"blockquote"},"If the contracts you're developing use Clarity 2, you must wait for this epoch to cross before deploying your contracts.")),(0,r.kt)("p",null,"These block heights can be customized using the settings in the devnet.toml:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-toml"},"[devnet]\nepoch_2_05 = 102\nepoch_2_1 = 106\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"NOTE:")),"\nIf you have trouble or find issues, you can report them ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/hirosystems/clarinet/issues"},"here"),".")),(0,r.kt)("h2",{id:"stacks-blockchain-api"},"Stacks Blockchain API"),(0,r.kt)("p",null,"The following updates for the API endpoints are for the Stacks 2.1 upgrade."),(0,r.kt)("h3",{id:"distinguish-contract-versions"},"Distinguish contract versions"),(0,r.kt)("p",null,"This section explains the new property returned with the following existing endpoints."),(0,r.kt)("p",null,"The endpoints ",(0,r.kt)("inlineCode",{parentName:"p"},"/extended/v1/tx/<txid>")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"/extended/v1/contract/<contract-id>")," now return a new property, ",(0,r.kt)("inlineCode",{parentName:"p"},"clarity_version"),"."),(0,r.kt)("p",null,"The sample response with the new property is shown below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "tx_id": "0x33c573f5ed06f1feecaa4a9df0225e109416dbba9792abb0cd94869bbad4a88a",\n  "canonical": true,\n  "contract_id": "ST000000000000000000002AMW42H.pox-2",\n  "block_height": 2,\n  "clarity_version": 2, # <-- New\n  "source_code": ";; PoX testnet constants\\n;; Min/max number of reward cycles uSTX can be locked for..."\n}\n')),(0,r.kt)("p",null,"A sample response for a regular (non-versioned) smart contract transaction with Clarity version null is shown below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "tx_id": "0x55bb3a37f9b2e8c58905c95099d5fc21aa47d073a918f3b30cc5abe4e3be44c6",\n  "canonical": true,\n  "contract_id": "ST000000000000000000002AMW42H.bns",\n  "block_height": 1,\n  "clarity_version": null, # <-- New\n  "source_code": ";;;; Errors\\n(define-constant ERR_PANIC 0)..."\n}\n')),(0,r.kt)("h3",{id:"coinbase-payouts"},"Coinbase payouts"),(0,r.kt)("p",null,"The Stacks 2.1 upgrade supports alternate recipients for Coinbase transactions. The ",(0,r.kt)("inlineCode",{parentName:"p"},"alt_recipient")," value is passed in the blockchain transaction, and the API returns a new Coinbase ",(0,r.kt)("inlineCode",{parentName:"p"},"alt_recipient")," property on applicable requests; if you want to use the latest methods detailed above, you need to update ",(0,r.kt)("inlineCode",{parentName:"p"},"@stacks/stacking")," to version >=",(0,r.kt)("inlineCode",{parentName:"p"},"6.0.0"),"."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"alt_recipient")," value varies based on the standard vs. contract principal recipients."),(0,r.kt)("p",null,"Standard principal recipient sample:\n",(0,r.kt)("inlineCode",{parentName:"p"},'"alt_recipient": "ST2X2FYCY01Y7YR2TGC2Y6661NFF3SMH0NGXPWTV5" <-- New')),(0,r.kt)("p",null,"Contract principal recipient sample:\n",(0,r.kt)("inlineCode",{parentName:"p"},'"alt_recipient": "ST2X2FYCY01Y7YR2TGC2Y6661NFF3SMH0NGXPWTV5.hello_world" <-- New')),(0,r.kt)("h3",{id:"pox-2-support-for-rosetta-api"},"PoX-2 support for Rosetta API"),(0,r.kt)("p",null,"The PoX-2 support is extended to various functions mentioned ",(0,r.kt)("a",{parentName:"p",href:"#new-pox-interactive-functions-for-clarity"},"below")," and ",(0,r.kt)("a",{parentName:"p",href:"https://www.rosetta-api.org/"},"Rosetta API"),"."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Address format changes"),": Adding support for segwit/taproot/bech32 addresses in PoX-2."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Constructing stacking operations"),': Rosetta has built-in support for performing various "Stacking" operations, which perform PoX-1 contract calls under the hood. These need to be changed to PoX-2 contract calls.'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Parsing stacking operations"),': Adding support for performing various "Stacking" operations involving PoX-2 contract calls.')),(0,r.kt)("h2",{id:"stacksjs"},"Stacks.js"),(0,r.kt)("p",null,"Stacks 2.1 upgrade for Stacks.js include methods now accepting ",(0,r.kt)("inlineCode",{parentName:"p"},"poxAddress")," in more BTC address formats (P2PKH, P2SH, P2WPKH, P2WSH, P2TR) and new Stacking and ",(0,r.kt)("a",{parentName:"p",href:"#new-helper-methods"},"Helper")," methods."),(0,r.kt)("h3",{id:"new-pox-interactive-functions-for-clarity"},"New PoX interactive functions for Clarity"),(0,r.kt)("p",null,"This section explains the new PoX interactive functions/methods for Clarity. The following are the new ",(0,r.kt)("inlineCode",{parentName:"p"},"@stacks/stacking")," methods that interact with the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/stacksgov/sips/blob/feat/sip-015/sips/sip-015/sip-015-network-upgrade.md#new-method-stack-extend"},"new PoX functions added in 2.1"),"."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/stacksgov/sips/blob/7c6c69d37c0ab46c0c782bbb203f9eea6d4d42a4/sips/sip-015/sip-015-network-upgrade.md#new-method-stack-extend"},(0,r.kt)("inlineCode",{parentName:"a"},"stack-extend"))," = ",(0,r.kt)("inlineCode",{parentName:"li"},"client.stackExtend()")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/stacksgov/sips/blob/7c6c69d37c0ab46c0c782bbb203f9eea6d4d42a4/sips/sip-015/sip-015-network-upgrade.md#new-method-stack-increase"},(0,r.kt)("inlineCode",{parentName:"a"},"stack-increase"))," = ",(0,r.kt)("inlineCode",{parentName:"li"},"client.stackIncrease()")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/stacksgov/sips/blob/7c6c69d37c0ab46c0c782bbb203f9eea6d4d42a4/sips/sip-015/sip-015-network-upgrade.md#new-method-delegate-stack-extend"},(0,r.kt)("inlineCode",{parentName:"a"},"delegate-stack-extend"))," = ",(0,r.kt)("inlineCode",{parentName:"li"},"client.delegateStackExtend()")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/stacksgov/sips/blob/7c6c69d37c0ab46c0c782bbb203f9eea6d4d42a4/sips/sip-015/sip-015-network-upgrade.md#new-method-delegate-stack-increase"},(0,r.kt)("inlineCode",{parentName:"a"},"delegate-stack-increase"))," = ",(0,r.kt)("inlineCode",{parentName:"li"},"client.delegateStackIncrease()")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/stacksgov/sips/blob/7c6c69d37c0ab46c0c782bbb203f9eea6d4d42a4/sips/sip-015/sip-015-network-upgrade.md#new-method-stack-aggregation-commit-indexed"},(0,r.kt)("inlineCode",{parentName:"a"},"stack-aggregation-commit-indexed"))," = ",(0,r.kt)("inlineCode",{parentName:"li"},"client.stackAggregationCommitIndexed()")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/stacksgov/sips/blob/7c6c69d37c0ab46c0c782bbb203f9eea6d4d42a4/sips/sip-015/sip-015-network-upgrade.md#new-method-stack-aggregation-increase"},(0,r.kt)("inlineCode",{parentName:"a"},"stack-aggregation-increase"))," = ",(0,r.kt)("inlineCode",{parentName:"li"},"client.stackAggregationIncrease()"))),(0,r.kt)("h3",{id:"new-helper-methods"},"New helper methods"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://stacks.js.org/classes/_stacks_stacking.StackingClient#getAccountBalanceLocked"},(0,r.kt)("inlineCode",{parentName:"a"},"StackingClient.getAccountBalanceLocked()"))," gets the locked balance of the address from a node (",(0,r.kt)("inlineCode",{parentName:"li"},"/v2")," endpoint)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://stacks.js.org/classes/_stacks_stacking.StackingClient#getAccountExtendedBalances"},(0,r.kt)("inlineCode",{parentName:"a"},"StackingClient.getAccountExtendedBalances()"))," gets more detailed balances of the address from an API (",(0,r.kt)("inlineCode",{parentName:"li"},"/extended")," endpoint); this includes STX, FTs, and NFTs"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://stacks.js.org/classes/_stacks_stacking.StackingClient#getDelegationStatus"},(0,r.kt)("inlineCode",{parentName:"a"},"StackingClient.getDelegationStatus()"))," gets the ",(0,r.kt)("inlineCode",{parentName:"li"},"get-delegation-info")," information of the address from a node (read-only contract call)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://stacks.js.org/classes/_stacks_stacking.StackingClient#getPoxOperationInfo"},(0,r.kt)("inlineCode",{parentName:"a"},"StackingClient.getPoxOperationInfo()"))," gets information about the current period of transition to PoX-2"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://stacks.js.org/classes/_stacks_stacking.StackingClient#getStackingContract"},(0,r.kt)("inlineCode",{parentName:"a"},"StackingClient.getStackingContract()"))," gets the contract identifier (",(0,r.kt)("inlineCode",{parentName:"li"},"address.name"),") of the PoX-contract to use. This will be PoX-1, unless PoX-2 is available (anytime after the 2.1 fork).")),(0,r.kt)("h3",{id:"migration"},"Migration"),(0,r.kt)("p",null,"Previous ",(0,r.kt)("inlineCode",{parentName:"p"},"@stacks/stacking")," releases will automatically switch to the new PoX contract (in Period 2b)."),(0,r.kt)("p",null,"However, if you want to use the new methods detailed above, you need to update to ",(0,r.kt)("inlineCode",{parentName:"p"},"@stacks/stacking")," to a version >=",(0,r.kt)("inlineCode",{parentName:"p"},"6.0.0"),". The updated release will also always prefer PoX-2 if possible. Use the following command to update the version."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"npm install @stacks/stacking@^6.0.0\n")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"There will be a short period of time (",(0,r.kt)("a",{parentName:"p",href:"https://www.hiro.so/blog/how-the-stacks-2-1-transition-impacts-stacking#overview-of-transition-periods"},"Period 2a"),"), where old versions ",(0,r.kt)("inlineCode",{parentName:"p"},"@stacks/stacking")," (<",(0,r.kt)("inlineCode",{parentName:"p"},"6.0.0"),") will stack to PoX-1, even though PoX-2 is available.")),(0,r.kt)("h2",{id:"references"},"References"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.hiro.so/blog/a-developers-guide-to-stacks-2-1"},"Developers guide to Stacks 2.1")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.hiro.so/blog/how-the-stacks-2-1-transition-impacts-stacking"},"How the Stacks 2.1 transition impacts stacking")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.google.com/document/u/1/d/e/2PACX-1vR93NPFIrQphHBmeVtUrUgCeKGX5i03xRcT1Lvb1jcWzpgh65ndbSFaHRwJvpBtmBw9HD8OZ-pwTpiU/pub"},"STX Mining report - July 2022")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://medium.com/@sonkaos999/the-bullish-case-for-stacks-8ef75849861f"},"Bullish case for Stacks"))))}k.isMDXComponent=!0},48133:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/integrate-epoch-changes-8aded63b4b13017c9c40b8df83827208.png"},49407:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/stacks_2.1_periods-95a9bf96dd66ea25e922b7491e9c672d.jpeg"}}]);