<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-hiro-archive/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Overview | capybara</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://CapybaraIO.github.io/doc/hiro-archive"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Overview | capybara"><meta data-rh="true" name="description" content="The Capybara Archive is a collection of datasets for various services in the Stacks ecosystem."><meta data-rh="true" property="og:description" content="The Capybara Archive is a collection of datasets for various services in the Stacks ecosystem."><link data-rh="true" rel="icon" href="/doc/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://CapybaraIO.github.io/doc/hiro-archive"><link data-rh="true" rel="alternate" href="https://CapybaraIO.github.io/doc/hiro-archive" hreflang="en"><link data-rh="true" rel="alternate" href="https://CapybaraIO.github.io/doc/hiro-archive" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://UL2NZRAK8K-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="capybara" href="/doc/opensearch.xml">

<link rel="preconnect" href="https://cdn.segment.io">
<script>!function(){var e=window.analytics=window.analytics||[];if(!e.initialize)if(e.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{e.invoked=!0,e.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"],e.factory=function(t){return function(){if(window.analytics.initialized)return window.analytics[t].apply(window.analytics,arguments);var a=Array.prototype.slice.call(arguments);return a.unshift(t),e.push(a),e}};for(var t=0;t<e.methods.length;t++){var a=e.methods[t];e[a]=e.factory(a)}e.load=function(t,a){var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src="https://cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(i,n),e._loadOptions=a},e._writeKey="qabJfWPhi2L9CeMk22A1XlYmabsNtgKy",e.SNIPPET_VERSION="4.16.1",e.load("qabJfWPhi2L9CeMk22A1XlYmabsNtgKy"),e.page()}}()</script>
<!-- Google Tag Manager -->
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-59XXGSG",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>
<!-- End Google Tag Manager --><link rel="stylesheet" href="/doc/assets/css/styles.281c0b25.css">
<link rel="preload" href="/doc/assets/js/runtime~main.63eaacc7.js" as="script">
<link rel="preload" href="/doc/assets/js/main.873bcaee.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/doc/"><div class="navbar__logo"><img src="/doc/img/hiro-docs-logo.svg" alt="capybara" class="themedImage_ToTc themedImage--light_HNdA hiro-logo"><img src="/doc/img/hiro-docs-logo-dark.svg" alt="capybara" class="themedImage_ToTc themedImage--dark_i4oU hiro-logo"></div></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link dropdown-nav">API References</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/doc/ordinals">Ordinals API</a></li><li><a class="dropdown__link" href="/doc/api">Stacks Blockchain API</a></li><li><a class="dropdown__link" href="/doc/metadata">Token Metadata API</a></li></ul></div><a href="https://github.com/CapybaraIO/doc" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" title="GitHub Repository" aria-label="GitHub Repository"></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item hidden"><a class="menu__link" href="/doc/">Home</a></li><div class="flex items-center cursor-default"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/hacks">Capybara Hacks</a></li><span class="inline-flex items-center rounded-md bg-orange-50 dark:bg-red-400/10 px-2 py-1 text-xs font-medium text-orange-700 dark:text-orange-400 ring-1 ring-inset ring-orange-600/10 dark:ring-orange-400/20">New</span></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item section-title">Tools</li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/platform">Capybara Platform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item section-title">Ordinals</li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/ordinals-explorer">Ordinals Explorer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/ordinals-api">Ordinals API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/ordhook">Ordhook</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item section-title">Stacks</li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/chainhook">Chainhook</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/clarinet">Clarinet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/explorer">Stacks Explorer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/stacks.js">Stacks.js</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/stacks-blockchain-api">Stacks API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/token-metadata-api">Token Metadata API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/subnets">Subnets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/doc/hiro-archive">Capybara Archive</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item section-title">Other</li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/api-keys">API Keys</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/rate-limiting">Rate Limiting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/changelog">Changelog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/contributors-guide">Contributors Guide</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a href="https://www.hiro.so/blog/release-roundup-october-2023" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false">Release History</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_RiV8"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/doc/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Capybara Archive</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Capybara Archive Overview</h1><p>The Capybara Archive is a collection of datasets for various services in the Stacks ecosystem.</p><p>The purpose of the Capybara Archive is to enable Stacks developers and users to quickly bootstrap supported services with pre-loaded data, which otherwise could take days or weeks to acquire when syncing from genesis. This is a public service Capybara offers as a benefit to the Stacks community.</p><p>All available artifacts can be found here: <a href="https://archive.hiro.so" target="_blank" rel="noopener noreferrer">https://archive.hiro.so</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="supported-services">Supported Services<a href="#supported-services" class="hash-link" aria-label="Direct link to Supported Services" title="Direct link to Supported Services">​</a></h2><p>Nightly mainnet and testnet archives are published for the following services:</p><ul><li><a href="https://github.com/stacks-network/stacks-blockchain" target="_blank" rel="noopener noreferrer">Stacks Blockchain</a></li><li><a href="https://github.com/hirosystems/stacks-blockchain-api" target="_blank" rel="noopener noreferrer">Stacks Blockchain API</a></li><li><a href="https://github.com/hirosystems/token-metadata-api" target="_blank" rel="noopener noreferrer">Token Metadata API</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="stacks-blockchain">Stacks Blockchain<a href="#stacks-blockchain" class="hash-link" aria-label="Direct link to Stacks Blockchain" title="Direct link to Stacks Blockchain">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="where-to-download-archives">Where to Download Archives<a href="#where-to-download-archives" class="hash-link" aria-label="Direct link to Where to Download Archives" title="Direct link to Where to Download Archives">​</a></h3><p>Stacks Blockchain archives for each network can be found at the following locations:</p><ul><li>mainnet: <a href="https://archive.hiro.so/mainnet/stacks-blockchain/" target="_blank" rel="noopener noreferrer">https://archive.hiro.so/mainnet/stacks-blockchain/</a></li><li>testnet: <a href="https://archive.hiro.so/testnet/stacks-blockchain/" target="_blank" rel="noopener noreferrer">https://archive.hiro.so/testnet/stacks-blockchain/</a></li></ul><p>The file name patterns are as follows:</p><ul><li>archive: <code>&lt;NETWORK&gt;-stacks-blockchain-&lt;VERSION&gt;-&lt;DATE(YYYYMMDD)&gt;.tar.gz</code></li><li>shasum: <code>&lt;NETWORK&gt;-stacks-blockchain-&lt;VERSION&gt;-&lt;DATE(YYYYMMDD)&gt;.sha256</code></li></ul><p>There is a continually updated archive and shasum which always points to the most recent upload:</p><ul><li>archive: <code>&lt;NETWORK&gt;-stacks-blockchain-latest.tar.gz</code></li><li>shasum: <code>&lt;NETWORK&gt;-stacks-blockchain-latest.sha256</code></li></ul><p>or the most recent upload for a particular version:</p><ul><li>archive: <code>&lt;NETWORK&gt;-stacks-blockchain-2.3.0.0.2-latest.tar.gz</code></li><li>shasum: <code>&lt;NETWORK&gt;-stacks-blockchain-2.3.0.0.2-latest.sha256</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="restoring-the-stacks-blockchain-node-using-the-capybara-archive">Restoring the Stacks Blockchain Node Using the Capybara Archive<a href="#restoring-the-stacks-blockchain-node-using-the-capybara-archive" class="hash-link" aria-label="Direct link to Restoring the Stacks Blockchain Node Using the Capybara Archive" title="Direct link to Restoring the Stacks Blockchain Node Using the Capybara Archive">​</a></h3><ol><li><a href="#where-to-download-archives">Download the archive and shasum for the appropriate network</a></li><li><a href="#verifying-integrity">Verify the archive with the shasum</a></li><li>Extract the archive into the desired directory<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Target directory must already exist</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">tar</span><span class="token plain"> -zxvf </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">ARCHIVE FILE</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> -C /target/directory</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><a href="https://docs.stacks.co/docs/nodes-and-miners/stacks-node-configuration#node" target="_blank" rel="noopener noreferrer">Configure the <code>working_dir</code> property in your Stacks Blockchain node Config.toml file</a> to match the directory you extracted the archive to. </li><li>Launch your Stacks Blockchain node. <a href="https://github.com/stacks-network/stacks-blockchain/tree/master/testnet/stacks-node/conf" target="_blank" rel="noopener noreferrer">You can use one of these example configuration files as a reference.</a></li><li>Verify the dataset is being used by comparing your nodes <a href="http://localhost:20443/v2/info" target="_blank" rel="noopener noreferrer">local block height</a> with <a href="https://api.hiro.so/v2/info" target="_blank" rel="noopener noreferrer">Capybara&#x27;s</a>. If the block height matches or is close to Capybara&#x27;s block height, the restoration was successful.<ol><li>It may take a few minutes for the local node to respond on this endpoint.</li><li>Your block height may be up to a few hundred blocks away from Capybara&#x27;s depending on the age of the archive. It should catch up relatively quickly.</li></ol></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="stacks-blockchain-api">Stacks Blockchain API<a href="#stacks-blockchain-api" class="hash-link" aria-label="Direct link to Stacks Blockchain API" title="Direct link to Stacks Blockchain API">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h3><p>Since the Stacks Blockchain API depends on a Stacks Blockchain node being at the same block height, you will need to first <a href="#restoring-the-stacks-blockchain-node-using-the-hiro-archive">restore a Stacks Blockchain node using the Capybara Archive</a> before restoring the Stacks Blockchain API. Otherwise, you may encounter errors when running the API.</p><p>In order for the Stacks Blockchain and Stacks Blockchain API archives to be compatible, they must meet the following criteria:</p><ul><li>Both archives correspond to the same Stacks network (mainnet/testnet)</li><li>The API archive version must be compatible with the Stacks Blockchain archive version (See <a href="https://github.com/hirosystems/stacks-blockchain-api/releases" target="_blank" rel="noopener noreferrer">API release notes</a> for guidance)</li><li>Both archives were created on the same date</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="restoration-methods">Restoration Methods<a href="#restoration-methods" class="hash-link" aria-label="Direct link to Restoration Methods" title="Direct link to Restoration Methods">​</a></h3><p>There are two ways to restore a Stacks Blockchain API using the Capybara Archive. The archive file you&#x27;ll need to download will depend on your method of restoration. There is no scenario where you would need both restoration methods.</p><p><strong>Restore via Postgres database dump (Recommended)</strong></p><p>This is the quickest and most direct method, and is suitable for most scenarios. It consists of a backup of the API&#x27;s Postgres database taken using <code>pg_dump</code>. We generally recommend starting with this method before attempting the method below if this one does not work for any reason.</p><p><strong>Restore via tab-separated-values (TSV) file</strong></p><p>This method is several times slower than restoring from a Postgres dump. The API TSV file contains the raw unprocessed events from a Stacks Blockchain node. The API can ingest this file to process events into a Postgres database.
Restoring from a TSV file can be useful when a Postgres database archive for a particular API version is not available or when it cannot be used for any reason.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="where-to-download-archives-1">Where to Download Archives<a href="#where-to-download-archives-1" class="hash-link" aria-label="Direct link to Where to Download Archives" title="Direct link to Where to Download Archives">​</a></h3><p>Depending on the <a href="#restoration-methods">restoration method</a>, Stacks Blockchain API archives for each network can be found at the following locations:</p><ul><li>Postgres database dump<ul><li>mainnet: <a href="https://archive.hiro.so/mainnet/stacks-blockchain-api-pg/" target="_blank" rel="noopener noreferrer">https://archive.hiro.so/mainnet/stacks-blockchain-api-pg/</a></li><li>testnet: <a href="https://archive.hiro.so/testnet/stacks-blockchain-api-pg/" target="_blank" rel="noopener noreferrer">https://archive.hiro.so/testnet/stacks-blockchain-api-pg/</a></li></ul></li><li>TSV file<ul><li>mainnet: <a href="https://archive.hiro.so/mainnet/stacks-blockchain-api/" target="_blank" rel="noopener noreferrer">https://archive.hiro.so/mainnet/stacks-blockchain-api/</a></li><li>testnet: <a href="https://archive.hiro.so/testnet/stacks-blockchain-api/" target="_blank" rel="noopener noreferrer">https://archive.hiro.so/testnet/stacks-blockchain-api/</a></li></ul></li></ul><p>The file name patterns are as follows:</p><ul><li>Postgres database dump<ul><li>archive: <code>stacks-blockchain-api-pg-&lt;DATABASE VERSION&gt;-&lt;API VERSION&gt;-&lt;DATE(YYYYMMDD)&gt;.dump</code></li><li>shasum: <code>stacks-blockchain-api-pg-&lt;DATABASE VERSION&gt;-&lt;API VERSION&gt;-&lt;DATE(YYYYMMDD)&gt;.sha256</code></li></ul></li><li>TSV file<ul><li>archive: <code>&lt;network&gt;-stacks-blockchain-api-&lt;API VERSION&gt;-&lt;DATE(YYYYMMDD)&gt;.gz</code></li><li>shasum: <code>&lt;network&gt;-stacks-blockchain-api-&lt;API VERSION&gt;-&lt;DATE(YYYYMMDD)&gt;.sha256</code></li></ul></li></ul><p>There is a continually updated archive and shasum which always points to the most recent upload:</p><ul><li>Postgres database dump<ul><li>archive: <code>stacks-blockchain-api-pg-&lt;DATABASE VERSION&gt;-latest.dump</code></li><li>shasum: <code>stacks-blockchain-api-pg-&lt;DATABASE VERSION&gt;-latest.sha256</code></li></ul></li><li>TSV file<ul><li>archive: <code>&lt;network&gt;-stacks-blockchain-api-latest.gz</code></li><li>shasum: <code>&lt;network&gt;-stacks-blockchain-api-latest.sha256</code></li></ul></li></ul><p>or the most recent upload for a particular version:</p><ul><li>Postgres database dump<ul><li>archive: <code>stacks-blockchain-api-pg-&lt;DATABASE VERSION&gt;-&lt;API VERSION&gt;-latest.dump</code></li><li>shasum: <code>stacks-blockchain-api-pg-&lt;DATABASE VERSION&gt;-&lt;API VERSION&gt;-latest.sha256</code></li></ul></li><li>TSV file<ul><li>archive: <code>&lt;network&gt;-stacks-blockchain-api-&lt;API VERSION&gt;-latest.gz</code></li><li>shasum: <code>&lt;network&gt;-stacks-blockchain-api-&lt;API VERSION&gt;-latest.sha256</code></li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="restoring-the-stacks-blockchain-api-using-the-capybara-archive">Restoring the Stacks Blockchain API Using the Capybara Archive<a href="#restoring-the-stacks-blockchain-api-using-the-capybara-archive" class="hash-link" aria-label="Direct link to Restoring the Stacks Blockchain API Using the Capybara Archive" title="Direct link to Restoring the Stacks Blockchain API Using the Capybara Archive">​</a></h3><p><strong>If restoring via Postgres dump</strong></p><ol><li><a href="#where-to-download-archives-1">Download the archive and shasum for the appropriate network and restoration method</a></li><li><a href="#verifying-integrity">Verify the archive with the shasum</a></li><li>Import the archive file into a running Postgres database (may take up to an hour depending on database specs and tuning)<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">PGPASSWORD</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">YOUR POSTGRES PASSWORD</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    pg_restore --username postgres --verbose --jobs </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token plain"> --dbname stacks_blockchain_api /path/to/archive/file</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li>Launch the Stacks Blockchain API service</li><li>Verify the dataset is being used by comparing your nodes <a href="http://localhost:3999/extended/v1/status" target="_blank" rel="noopener noreferrer">local block height</a> with <a href="https://api.hiro.so/extended/v1/status" target="_blank" rel="noopener noreferrer">Capybara&#x27;s</a>. If the block height matches or is close to Capybara&#x27;s block height, the restoration was successful.<ol><li>It may take a few minutes for the local node to respond on this endpoint.</li><li>Your block height may be up to a few hundred blocks away from Capybara&#x27;s depending on the age of the archive. It should catch up relatively quickly.</li></ol></li></ol><p><strong>If restoring via TSV file</strong></p><ol><li><a href="#where-to-download-archives-1">Download the archive and shasum for the appropriate network and restoration method</a></li><li><a href="#verifying-integrity">Verify the archive with the shasum</a></li><li>Extract the archive into the desired directory<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Target directory must already exist</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token function" style="color:rgb(130, 170, 255)">gzip</span><span class="token plain"> -d </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">ARCHIVE FILE</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> --stdout </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> /path/to/extracted/file</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><a href="https://github.com/hirosystems/stacks-blockchain-api#export-and-import" target="_blank" rel="noopener noreferrer">Follow these directions to process and import the events in the TSV file into your Postgres database.</a></li><li>Launch the Stacks Blockchain API service</li><li>Verify the dataset is being used by comparing your nodes <a href="http://localhost:3999/extended/v1/status" target="_blank" rel="noopener noreferrer">local block height</a> with <a href="https://api.hiro.so/extended/v1/status" target="_blank" rel="noopener noreferrer">Capybara&#x27;s</a>. If the block height matches or is close to Capybara&#x27;s block height, the restoration was successful.<ol><li>It may take a few minutes for the local node to respond on this endpoint.</li><li>Your block height may be up to a few hundred blocks away from Capybara&#x27;s depending on the age of the archive. It should catch up relatively quickly.</li></ol></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="token-metadata-api">Token Metadata API<a href="#token-metadata-api" class="hash-link" aria-label="Direct link to Token Metadata API" title="Direct link to Token Metadata API">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites-1">Prerequisites<a href="#prerequisites-1" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h3><p>Since the Token Metadata API depends on a Stacks Blockchain API, you will need to first launch a Stacks Blockchain API configured for the same Stacks network.</p><p>If you don&#x27;t already have one, you can follow <a href="#stacks-blockchain-api">these instructions</a> to launch one with an archive.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="where-to-download-archives-2">Where to Download Archives<a href="#where-to-download-archives-2" class="hash-link" aria-label="Direct link to Where to Download Archives" title="Direct link to Where to Download Archives">​</a></h3><p>Token Metadata API archives for each network can be found at the following locations:</p><ul><li>mainnet: <a href="https://archive.hiro.so/mainnet/token-metadata-api-pg/" target="_blank" rel="noopener noreferrer">https://archive.hiro.so/mainnet/token-metadata-api-pg/</a></li><li>testnet: <a href="https://archive.hiro.so/testnet/token-metadata-api-pg/" target="_blank" rel="noopener noreferrer">https://archive.hiro.so/testnet/token-metadata-api-pg/</a></li></ul><p>The file name patterns are as follows:</p><ul><li>archive: <code>token-metadata-api-pg-&lt;DATABASE VERSION&gt;-&lt;API VERSION&gt;-&lt;DATE(YYYYMMDD)&gt;.dump</code></li><li>shasum: <code>token-metadata-api-pg-&lt;DATABASE VERSION&gt;-&lt;API VERSION&gt;-&lt;DATE(YYYYMMDD)&gt;.sha256</code></li></ul><p>There is a continually updated archive and shasum which always points to the most recent upload:</p><ul><li>archive: <code>token-metadata-api-pg-&lt;DATABASE VERSION&gt;-latest.dump</code></li><li>shasum: <code>token-metadata-api-pg-&lt;DATABASE VERSION&gt;-latest.sha256</code></li></ul><p>or the most recent upload for a particular version:</p><ul><li>archive: <code>token-metadata-api-pg-&lt;DATABASE VERSION&gt;-&lt;API VERSION&gt;-latest.dump</code></li><li>shasum: <code>token-metadata-api-pg-&lt;DATABASE VERSION&gt;-&lt;API VERSION&gt;-latest.sha256</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="restoring-the-token-metadata-api-using-the-capybara-archive">Restoring the Token Metadata API Using the Capybara Archive<a href="#restoring-the-token-metadata-api-using-the-capybara-archive" class="hash-link" aria-label="Direct link to Restoring the Token Metadata API Using the Capybara Archive" title="Direct link to Restoring the Token Metadata API Using the Capybara Archive">​</a></h3><ol><li><a href="#where-to-download-archives-2">Download the archive and shasum for the appropriate network</a></li><li><a href="#verifying-integrity">Verify the archive with the shasum</a></li><li>Import the archive file into a running Postgres database (may take up to an hour depending on database specs and tuning)<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">PGPASSWORD</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">YOUR POSTGRES PASSWORD</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    pg_restore --username postgres --verbose --jobs </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token plain"> --dbname token_metadata_api /path/to/archive/file</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li>Launch the Token Metadata API service</li><li>Verify the restoration was successful by viewing the <a href="http://localhost:3000/metadata" target="_blank" rel="noopener noreferrer">total number of tokens and contracts tracked in the service.</a> If the total number of each property is greater than zero, the restoration was successful.<ol><li>It may take a few minutes for the local node to respond on this endpoint.</li></ol></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="verifying-integrity">Verifying Integrity<a href="#verifying-integrity" class="hash-link" aria-label="Direct link to Verifying Integrity" title="Direct link to Verifying Integrity">​</a></h2><p>All datasets have an associated SHA256 hash file which can be used to verify the integrity of the downloaded dataset.
As some of the archives are quite large, this is useful to ensure the file you&#x27;ve downloaded matches the file maintained in the Archive.</p><p>After downloading an archive file and its associated shasum file, you can verify the integrity of the archive file like so:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token string variable" style="color:rgb(191, 199, 213)">$(</span><span class="token string variable function" style="color:rgb(130, 170, 255)">cat</span><span class="token string variable" style="color:rgb(191, 199, 213)"> </span><span class="token string variable operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token string variable" style="color:rgb(191, 199, 213)">SHASUM FILE</span><span class="token string variable operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token string variable" style="color:rgb(191, 199, 213)"> </span><span class="token string variable operator" style="color:rgb(137, 221, 255)">|</span><span class="token string variable" style="color:rgb(191, 199, 213)"> </span><span class="token string variable function" style="color:rgb(130, 170, 255)">awk</span><span class="token string variable" style="color:rgb(191, 199, 213)"> </span><span class="token string variable string" style="color:rgb(195, 232, 141)">&#x27;{print $1}&#x27;</span><span class="token string variable" style="color:rgb(191, 199, 213)">)</span><span class="token string" style="color:rgb(195, 232, 141)">  &lt;ARCHIVE FILE&gt;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> shasum --check</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">ARCHIVE FILE</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain">: OK</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Example</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token string variable" style="color:rgb(191, 199, 213)">$(</span><span class="token string variable function" style="color:rgb(130, 170, 255)">cat</span><span class="token string variable" style="color:rgb(191, 199, 213)"> mainnet-stacks-blockchain-api-latest.sha256 </span><span class="token string variable operator" style="color:rgb(137, 221, 255)">|</span><span class="token string variable" style="color:rgb(191, 199, 213)"> </span><span class="token string variable function" style="color:rgb(130, 170, 255)">awk</span><span class="token string variable" style="color:rgb(191, 199, 213)"> </span><span class="token string variable string" style="color:rgb(195, 232, 141)">&#x27;{print $1}&#x27;</span><span class="token string variable" style="color:rgb(191, 199, 213)">)</span><span class="token string" style="color:rgb(195, 232, 141)">  mainnet-stacks-blockchain-api-latest.gz&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> shasum --check</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># If the integrity check succeeds, a log will be printed indicating so</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    mainnet-stacks-blockchain-api-latest.gz: OK</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Otherwise a log will be printed indicating failure</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    mainnet-stacks-blockchain-api-latest.gz: FAILED</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    shasum: WARNING: </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> computed checksum did NOT match</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If the integrity check fails for any reason, you may need to delete the local archive and re-attempt the download. If issues persist, switch to a different network and try again.</p></div><div style="flex-direction:row;flex-wrap:wrap"><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/CapybaraIO/doc/tree/main/docs/hiro-archive/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col"></div></div></footer></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--next" href="/doc/api-keys"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">API Keys</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#supported-services" class="table-of-contents__link toc-highlight">Supported Services</a></li><li><a href="#stacks-blockchain" class="table-of-contents__link toc-highlight">Stacks Blockchain</a><ul><li><a href="#where-to-download-archives" class="table-of-contents__link toc-highlight">Where to Download Archives</a></li><li><a href="#restoring-the-stacks-blockchain-node-using-the-capybara-archive" class="table-of-contents__link toc-highlight">Restoring the Stacks Blockchain Node Using the Capybara Archive</a></li></ul></li><li><a href="#stacks-blockchain-api" class="table-of-contents__link toc-highlight">Stacks Blockchain API</a><ul><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#restoration-methods" class="table-of-contents__link toc-highlight">Restoration Methods</a></li><li><a href="#where-to-download-archives-1" class="table-of-contents__link toc-highlight">Where to Download Archives</a></li><li><a href="#restoring-the-stacks-blockchain-api-using-the-capybara-archive" class="table-of-contents__link toc-highlight">Restoring the Stacks Blockchain API Using the Capybara Archive</a></li></ul></li><li><a href="#token-metadata-api" class="table-of-contents__link toc-highlight">Token Metadata API</a><ul><li><a href="#prerequisites-1" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#where-to-download-archives-2" class="table-of-contents__link toc-highlight">Where to Download Archives</a></li><li><a href="#restoring-the-token-metadata-api-using-the-capybara-archive" class="table-of-contents__link toc-highlight">Restoring the Token Metadata API Using the Capybara Archive</a></li></ul></li><li><a href="#verifying-integrity" class="table-of-contents__link toc-highlight">Verifying Integrity</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/doc/img/hiro-docs-footer.svg" alt="Capybara developers" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/doc/img/hiro-docs-footer-light.svg" alt="Capybara developers" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></div><div class="footer__copyright">Copyright © 2023 capybara</div></div></div></footer></div>
<script src="/doc/assets/js/runtime~main.63eaacc7.js"></script>
<script src="/doc/assets/js/main.873bcaee.js"></script>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-59XXGSG" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) --></body>
</html>